-- ------------------------------
-- Export generated by Surrealist on 2024-07-31T02:08:22.712Z
-- ------------------------------

OPTION IMPORT;

-- ------------------------------
-- TABLE: in_league
-- ------------------------------

DEFINE TABLE in_league TYPE RELATION IN user OUT league SCHEMAFULL PERMISSIONS NONE;

DEFINE FIELD in ON in_league TYPE record<user> PERMISSIONS FULL;
DEFINE FIELD out ON in_league TYPE record<league> PERMISSIONS FULL;
DEFINE FIELD role ON in_league TYPE record<role> PERMISSIONS FULL;

DEFINE INDEX unique_relation ON in_league FIELDS in, out UNIQUE;

-- ------------------------------
-- TABLE: league
-- ------------------------------

DEFINE TABLE league TYPE NORMAL SCHEMAFULL PERMISSIONS NONE;

DEFINE FIELD created_at ON league TYPE datetime DEFAULT time::now() PERMISSIONS FULL;
DEFINE FIELD name ON league TYPE string PERMISSIONS FULL;
DEFINE FIELD roles ON league FLEXIBLE TYPE array<record<role>> PERMISSIONS FULL;
DEFINE FIELD roles[*] ON league FLEXIBLE TYPE record<role> PERMISSIONS FULL;

DEFINE INDEX name_unique ON league FIELDS name UNIQUE;

-- ------------------------------
-- TABLE: league_owner
-- ------------------------------

DEFINE TABLE league_owner TYPE RELATION IN user OUT league SCHEMAFULL PERMISSIONS NONE;

DEFINE FIELD in ON league_owner TYPE record<user> PERMISSIONS FULL;
DEFINE FIELD out ON league_owner TYPE record<league> PERMISSIONS FULL;

DEFINE INDEX out_unique ON league_owner FIELDS out UNIQUE;

-- ------------------------------
-- TABLE: role
-- ------------------------------

DEFINE TABLE role TYPE NORMAL SCHEMAFULL PERMISSIONS NONE;

DEFINE FIELD created_at ON role TYPE datetime DEFAULT time::now() PERMISSIONS FULL;
DEFINE FIELD created_by ON role TYPE record<user> PERMISSIONS FULL;
DEFINE FIELD level ON role TYPE int PERMISSIONS FULL;
DEFINE FIELD name ON role TYPE string PERMISSIONS FULL;
DEFINE FIELD permissions ON role FLEXIBLE TYPE object PERMISSIONS FULL;

-- ------------------------------
-- TABLE: user
-- ------------------------------

DEFINE TABLE user TYPE NORMAL SCHEMAFULL PERMISSIONS NONE;

DEFINE FIELD created_at ON user TYPE datetime DEFAULT time::now() PERMISSIONS FULL;
DEFINE FIELD email ON user TYPE string PERMISSIONS FULL;
DEFINE FIELD join_date ON user TYPE datetime PERMISSIONS FULL;
DEFINE FIELD password ON user TYPE string PERMISSIONS FULL;
DEFINE FIELD phone_number ON user TYPE string PERMISSIONS FULL;
DEFINE FIELD username ON user TYPE string PERMISSIONS FULL;
DEFINE FIELD verified ON user TYPE bool DEFAULT false PERMISSIONS FULL;

DEFINE INDEX email_unique ON user FIELDS email UNIQUE;
DEFINE INDEX username_unique ON user FIELDS username UNIQUE;